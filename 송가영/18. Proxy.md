## 🔸 Proxy란?
클라이언트와 서버 사이에 위치하여 그 사이의 HTTP 메시지를 정리하는 중개자입니다.  

<img src="https://user-images.githubusercontent.com/17793440/180641369-6ba646e7-a37f-4478-ac5e-cc864a8f8ad9.png" />


웹 프록시가 없다면 클라이언트는 HTTP 서버와 직접 통신하지만, 웹 프록시가 있다면 클라이언트는 HTTP 서버와 통신하는 대신 자신의 입장에서 서버와 대화해주는 프록시와 통신합니다.

**종류**
- 공유 프록시  
  여러 클라이언트가 함께 사용하는 프록시를 공용 프록시라고 하며, 대부분의 프록시는 공용이며 공유된 프록시입니다.  
  중앙 집중형으로 프록시를 관리하는 것이 비용 효율이 높고 쉬우며,  
  특히 캐시 프록시 서버와 같은 프록시는 여러 사용자들의 공통된 요청에서 이득을 취할 수 있기 때문에 사용자가 많을 수록 유리합니다.  
    
- 개인 프록시  
  하나의 클라이언트가 독점적으로 사용하는 프록시를 개인 프록시라고 히며, 브라우저의 기능을 확장하거나 성능을 개선하기 위해 사용됩니다.  

**Proxy vs 게이트웨이**   
 프록시는 같은 프로토콜을 사용하는 둘 이상의 어플리케이션을 연결하고, 게이트웨이는 서로 다른 프로토콜을 사용하는 둘 이상을 연결합니다.  
 게이트웨이는 클라이언트와 서버가 서로 다른 프로토콜을 사용하더라도 서로 간의 트랜잭션을 완료할 수 있도록 해주는 프로토콜 변환기처럼 동작합니다.

<img src="https://user-images.githubusercontent.com/17793440/180641123-958deede-0442-4b65-b8b3-6f76f70a804d.png" width="600px"/>

<br/><br/>

## 🔸 Proxy를 사용하는 이유  
보안을 개선하고, 성능을 높이고, 비용을 절약하기 위해 프록시를 사용합니다.  

- 어린이 필터   
  어린이에게 유해한 사이트를 차단하기 위해 필터링 프록시를 사용할 수 있습니다.  
  <img src="https://user-images.githubusercontent.com/17793440/180641424-2e3d520c-e043-42da-abfe-62d28ac2460b.png" width="500px"/>

- 문서 접근 제어자  
  기업에서 중앙 프록시 서버를 두어 웹 서버, 웹 리소스에 대해 접근 제어를 구현할 수 있습니다.  
  <img src="https://user-images.githubusercontent.com/17793440/180641549-10b39027-e694-425f-b8ed-159371dc1c6a.png" width="500px"/>
  
- 보안 방화벽  
  조직 안에 들어오거나 나가는 네트워크 흐름을 한 지점에서 통제하여 보안을 강화하기 위해 사용할 수 있습니다.  
  <img src="https://user-images.githubusercontent.com/17793440/180642682-347c29b4-be8c-4b45-a7f4-7fb3fb64ec23.png" width="500px"/> 
  
- 웹 캐시  
  접근이 많은 문서의 로컬 사본을 관리하고, 해당 문서에 대한 요청이 오면 빠르게 제공하여 느리고 비싼 인터넷 커뮤니케이션을 줄입니다.    
  <img src="https://user-images.githubusercontent.com/17793440/180642694-cc5ca4fc-95ba-41e2-b73c-7286e75f2bff.png" width="500px" />

  
- 대리 프록시  
  웹 서버인 것 처럼 동작하며, 리버스 프록시 또는 대리 프록시라고 부릅니다.  
  클라이언트가 서버를 요청할 때 리서브 프록시를 호출하고, 리버스 프록시가 컨텐츠가 있는 서버로부터 응답을 받아 다시 클라이언트에 전달합니다.  
  로드밸런싱, 보안, 성능 향상을 목적으로 사용합니다.  
  
  <img src="https://user-images.githubusercontent.com/17793440/180642709-69d0f56f-c7f0-43fd-8019-78d57a02b187.png" width="500px"/>

<br/><br/>

## 🔸 Proxy 서버 배치  
- 출구 프록시  
  로컬 네트워크와 더 큰 네트워크 사이의 트래픽을 제어하기 위해 프록시를 로컬 네트워크의 출구에 넣을 수 있습니다.  
  회사 외부의 해커들을 막는 방화벽을 제공하기 위해, 어린이의 유해 사이트 접근을 막는 필터링 프록시를 설정하기 위해 출구 프록시를 사용할 수 있습니다.  

- 접근 프록시  
  모든 요청을 종합적으로 처리하기 위해 ISP 접근 지점에 위치합니다.  

- 대리 프록시  
  대리 프록시는 보통 웹 서버들의 바로 앞에 위치합니다.    

- 네트워크 교환 프록시   
  캐시를 이용하여 혼잡을 완화하고 트래픽 흐름을 감시하기 위해 네트워크 사이에 위치합니다.  
  
<br/><br/>

## 🔸 Proxy 서버가 트래픽을 처리하도록 설정하는 방법
   클라이언트 트래픽이 프록시 서버로 가도록 설정하는 방법에는 4가지가 있습니다.  
   
 - 클라이언트 수정  
   웹 클라이언트는 수동/자동 프록시 설정을 지원합니다.  
   만약 클라이언트가 프록시를 사용하도록 설정되어 있으면, 클라이언트는 HTTP요청을 바로 프록시로 보냅니다.  
   
 - 네트워크 수정
   투명 프록시(Transparent Proxy)를 두어 클라이언트 모르게 트래픽을 프록시 서버로 보낼 수 있습니다.
   이 때 스위칭 장치와 라우팅 장치가 필요합니다.
   
 - DNS 이름공간 수정  
   대리 프록시와 같이 프록시 서버가 웹 서버의 이름과 IP주소를 사용하도록 하여, 모든 요청을 프록시 서버로 보낼 수 있습니다.  
   
  - 웹 서버 수정  
    HTTP 리다이렉션 명령(응답코드 : 305)을 클라이언트에 돌려줌으로써 클라이언트의 요청을 프록시 서버로 리다이렉트 되도록 설정할 수 있습니다.  
  
  <br/><br/>
    
## 🔸 Proxy 사용 특징
1. 클라이언트 요청 시에 Proxy URI와 서버 URI의 차이

: 클라이언트가 웹 서버로 요청을 보낼 때는 스킴, 호스트, 포트번호가 없는 부분 URI를 가집니다.  
 ex)  GET /index.html HTTP/1.0  

 클라이언트가 프록시로 요청을 보낼 때는 다음과 같이 완전한 URI를 갖습니다.  
 목적지 서버와 커넥션을 맺어야하기 때문에, 서버의 이름과 스킴을 알필요가 있습니다.  
 ex) GET http://www.google.com/index.html HTTP/1.0  

2. Via 헤더 
   요청 메시지가 프록시를 지날 때마다 Via 목록의 끝에 프록시 정보를 기록합니다.  
   Via 헤더를 통해 메시지의 전달을 추적할 수 있습니다.  
   (Trace 메서드를 통해서도 메시지의 변경/전달을 추적 가능함)  
   
  

     


